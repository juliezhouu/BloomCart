<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BloomCart</title>
  <link rel="stylesheet" href="popup.css">
  <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.11/dist/dotlottie-wc.js" type="module"></script>
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <header class="popup-header">
      <div class="logo">
        <svg class="leaf-icon" viewBox="0 0 24 24" width="24" height="24">
          <path d="M17,8C8,10 5.9,16.17 3.82,21.34L5.71,22L6.66,19.7C7.14,19.87 7.64,20 8,20C19,20 22,3 22,3C21,5 14,5.25 9,6.25C4,7.25 2,11.5 2,13.5C2,15.5 3.75,17.25 3.75,17.25C7,8 17,8 17,8Z"/>
        </svg>
        <h1>BloomCart</h1>
      </div>
      <div class="header-actions">
        <div class="status-badge">
          <span class="status-dot"></span>
          <span>Active</span>
        </div>
        <button class="close-btn" id="close-btn" title="Close popup">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Current Product / Cart Status -->
    <section class="current-product" id="current-product">
      <h2 id="product-title">Loading cart...</h2>
      <p id="product-brand">Checking your Amazon cart</p>
    </section>

    <!-- Cart Items List -->
    <section class="cart-items-section" id="cart-items-section" style="display: none;">
      <div class="cart-items-header">
        <span class="cart-items-title">Your Cart Items</span>
        <span class="cart-items-count" id="cart-items-count">0</span>
      </div>
      <div class="cart-items-list" id="cart-items-list"></div>
      <div class="cart-summary" id="cart-summary">
        <span>Average Sustainability</span>
        <span class="cart-avg-score" id="cart-avg-score">--</span>
      </div>
    </section>

    <!-- Sustainability Score -->
    <section class="score-section" id="score-section">
      <div class="score-badge">
        <div class="score-circle">
          <span id="score-number">0</span>
        </div>
        <div class="score-sparkle">✨</div>
      </div>
      <h3 id="score-label">Calculating...</h3>
      <p id="score-tier">Tier 0 of 7</p>

      <!-- Tier Progress Bar -->
      <div class="tier-progress">
        <div class="tier-bar tier-1"></div>
        <div class="tier-bar tier-2"></div>
        <div class="tier-bar tier-3"></div>
        <div class="tier-bar tier-4"></div>
        <div class="tier-bar tier-5"></div>
        <div class="tier-bar tier-6"></div>
        <div class="tier-bar tier-7"></div>
      </div>
    </section>

    <!-- Collapsible Sustainability Details -->
    <section class="sustainability-details collapsed" id="sustainability-details">
      <button class="details-toggle" id="details-toggle">
        <span>Sustainability Details</span>
        <svg class="chevron" viewBox="0 0 24 24" width="16" height="16">
          <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
        </svg>
      </button>
      <div class="details-content" id="details-content">
        <div class="detail-item">
          <span class="detail-label">Environmental</span>
          <span class="detail-value" id="detail-environmental">-</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Social</span>
          <span class="detail-value" id="detail-social">-</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Economic</span>
          <span class="detail-value" id="detail-economic">-</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Carbon Footprint</span>
          <span class="detail-value" id="detail-carbon">-</span>
        </div>
      </div>
    </section>

    <!-- Flower Garden -->
    <section class="flower-garden">
      <div class="garden-bg"></div>
      <div class="flower-container" id="flower-container">
        <img 
          id="plant-image" 
          src="assets/images/plant-stages/plant-stage-1.jpg" 
          alt="Your Plant" 
          class="plant-stage-image"
          onerror="this.style.display='none'; console.error('Plant image failed to load');"
        />
      </div>
      <h3 class="garden-title">Your Bloom</h3>
      <button class="preview-btn" id="preview-btn">Preview</button>
    </section>

    <!-- Add to Cart Button -->
    <button class="cart-button" id="cart-button">
      <svg viewBox="0 0 24 24" width="20" height="20">
        <path d="M17,18C15.89,18 15,18.89 15,20A2,2 0 0,0 17,22A2,2 0 0,0 19,20C19,18.89 18.1,18 17,18M1,2V4H3L6.6,11.59L5.24,14.04C5.09,14.32 5,14.65 5,15A2,2 0 0,0 7,17H19V15H7.42A0.25,0.25 0 0,1 7.17,14.75C7.17,14.7 7.18,14.66 7.2,14.63L8.1,13H15.55C16.3,13 16.96,12.58 17.3,11.97L20.88,5.5C20.95,5.34 21,5.17 21,5A1,1 0 0,0 20,4H5.21L4.27,2M7,18C5.89,18 5,18.89 5,20A2,2 0 0,0 7,22A2,2 0 0,0 9,20C9,18.89 8.1,18 7,18Z"/>
      </svg>
      <span>Add to Cart & Grow Garden</span>
    </button>

    <!-- Footer -->
    <footer class="popup-footer">
      <p>BloomCart Extension • v1.0</p>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
